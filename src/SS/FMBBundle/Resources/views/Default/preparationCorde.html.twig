{% extends "::base.html.twig" %}
{% block title %}{{ parent() }} - FMB{% endblock %}
{% block stylesheet %}
    {{ parent() }}
    <link href="{{ asset('bundles/ssfmb/plugins/timepicker/bootstrap-timepicker.min.css') }}" rel="stylesheet">
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css') }}"
          rel="stylesheet">
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css') }}"
          rel="stylesheet">
    <link href="{{ asset('bundles/ssfmb/plugins/clockpicker/css/bootstrap-clockpicker.min.css') }}" rel="stylesheet">
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-daterangepicker/daterangepicker.css') }}" rel="stylesheet">
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-tagsinput/css/bootstrap-tagsinput.css') }}" rel="stylesheet"/>
    <link href="{{ asset('bundles/ssfmb/plugins/switchery/css/switchery.min.css') }}" rel="stylesheet"/>
    <link href="{{ asset('bundles/ssfmb/plugins/multiselect/css/multi-select.css') }}" rel="stylesheet"
          type="text/css"/>
    <link href="{{ asset('bundles/ssfmb/plugins/select2/css/select2.min.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-select/css/bootstrap-select.min.css') }}" rel="stylesheet"/>
    <link href="{{ asset('bundles/ssfmb/plugins/bootstrap-touchspin/css/jquery.bootstrap-touchspin.min.css') }}"
          rel="stylesheet"/>


{% endblock %}
{% block header %} {{ parent() }}{% endblock %}
{% block body %}
    {{ parent() }}
    {% set page = 'PrCr' %}
    <div class="row">
        <div class="col-sm-12">
            <div class="card-box">
                <div class="row">
                    <div class="col-md-6">
                        <h4 class="m-t-0 header-title"><b>Preparation Corde </b></h4>
                        <p class="text-muted m-b-30 font-13">
                        </p>
                        {{ form_start(form) }}
                        {{ form_errors(form) }}
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.Parc) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.Parc) }}
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.libStock) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.libStock) }}
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.nomCorde) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.nomCorde) }}
                            </div>
                        </div>
                        <div class="form-group" id="divqteenstocks">
                            <div class="col-md-4">
                                {{ form_label(form.quantiterEnStock) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.quantiterEnStock) }}
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.date) }}
                            </div>
                            <div class="col-md-8">
                                <div class="input-group">
                                    {{ form_widget(form.date) }}
                                    <span class="input-group-addon bg-custom b-0 text-white"><i
                                                class="icon-calender"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.refArticle) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.refArticle) }}
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.numeroSerie) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.numeroSerie) }}
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.qte) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.qte) }}
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-md-4">
                                {{ form_label(form.nombre) }}
                            </div>
                            <div class="col-md-8">
                                {{ form_widget(form.nombre) }}
                            </div>
                        </div>
                        <div class="col-md-4">
                        </div>
                        {{ form_end(form) }}
                    </div>
                    <div class="col-md-1">
                        <div class="custom-dd dd" id="nestable_list_1">
                        </div>
                    </div><!-- end col -->
                    <!-- end col -->
                </div> <!-- end row -->
            </div> <!-- end card-box -->
        </div> <!-- end col -->
    </div>
    <!-- end Row -->

    {% block footer %}
        {{ parent() }}
    {% endblock %}
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/ssfmb/plugins/moment/moment.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/timepicker/bootstrap-timepicker.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-datepicker/js/bootstrap-datepicker.fr.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/clockpicker/js/bootstrap-clockpicker.min.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-daterangepicker/daterangepicker.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/pages/jquery.form-pickers.init.js') }}"></script>

    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-tagsinput/js/bootstrap-tagsinput.min.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/switchery/js/switchery.min.js') }}"></script>
    <script type="text/javascript"
            src="{{ asset('bundles/ssfmb/plugins/multiselect/js/jquery.multi-select.js') }}"></script>
    <script type="text/javascript"
            src="{{ asset('bundles/ssfmb/plugins/jquery-quicksearch/jquery.quicksearch.js') }}"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/select2/js/select2.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-select/js/bootstrap-select.min.js') }}"
            type="text/javascript"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-filestyle/js/bootstrap-filestyle.min.js') }}"
            type="text/javascript"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-touchspin/js/jquery.bootstrap-touchspin.min.js') }}"
            type="text/javascript"></script>
    <script src="{{ asset('bundles/ssfmb/plugins/bootstrap-maxlength/bootstrap-maxlength.min.js') }}"
            type="text/javascript"></script>



    <script type="text/javascript"
            src="{{ asset('bundles/ssfmb/plugins/autocomplete/jquery.mockjax.js') }}"></script>
    <script type="text/javascript"
            src="{{ asset('bundles/ssfmb/plugins/autocomplete/jquery.autocomplete.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/ssfmb/plugins/autocomplete/countries.js') }}"></script>

    <script type="text/javascript" src="{{ asset('bundles/ssfmb/pages/jquery.form-advanced.init.js') }}"></script>

    {# Voici le script en question : #}
    <script type="text/javascript">
        $(document).ready(function () {
            jQuery('#ss_fmbbundle_preparationcorde_date').datepicker({language: 'fr'});
            jQuery('#ss_fmbbundle_preparationcorde_libStock').hide();
            jQuery('#ss_fmbbundle_preparationcorde_nomCorde').hide();
            jQuery('#ss_fmbbundle_preparationcorde_qte').hide();
            jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').hide();
            jQuery('#ss_fmbbundle_preparationcorde_submit').hide();
            jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').hide()
            jQuery('#ss_fmbbundle_preparationcorde_Parc').ready(function () {
                var val = jQuery("#ss_fmbbundle_preparationcorde_Parc").val();

                jQuery.ajax({
                    type: "POST",
                    url: "{{ url('ssfmb_parcstock') }}?parc_id=" + val,
                    success: function (data) {
                        if (jQuery.trim(data)) {
                            jQuery('#ss_fmbbundle_preparationcorde_libStock').show();

                            // Remove current options
                            jQuery('#ss_fmbbundle_preparationcorde_libStock').html('');
                            jQuery.each(data, function (k, v) {
                                jQuery('#ss_fmbbundle_preparationcorde_libStock').append('<option value="' + v + '">' + k + '</option>');
                            });
                            jQuery.ajax({
                                type: "POST",
                                url: "{{ url('ssfmb_parccorde') }}?parc_id=" + val,
                                success: function (data) {
                                    if (jQuery.trim(data)) {
                                        var pos = true;
                                        var lan = '';
                                        jQuery('#ss_fmbbundle_preparationcorde_nomCorde').show();

                                        // Remove current options
                                        jQuery('#ss_fmbbundle_preparationcorde_nomCorde').html('');
                                        jQuery.each(data, function (k, v) {
                                            if (pos) {
                                                lan = k;
                                                jQuery('#ss_fmbbundle_preparationcorde_nomCorde').append('<option value="' + v + '">' + k + '</option>');
                                                pos = false;
                                            } else {
                                                if (jQuery('#ss_fmbbundle_preparationcorde_nomCorde').val() == lan) {
                                                    jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').show();
                                                    jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').val(v);
                                                }
                                                pos = true;

                                            }
                                        });
                                        jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                                    }
                                }
                            });
                            jQuery.noConflict();
                            jQuery.ajax({
                                type: "POST",
                                url: "{{ url('ssfmb_articlestock') }}?stock_id=" + jQuery('#ss_fmbbundle_preparationcorde_libStock').val() + "&article=" + jQuery('#ss_fmbbundle_preparationcorde_refArticle').val(),
                                success: function (data) {
                                    if (jQuery.trim(data)) {
                                        var pos = true;
                                        var lan = '';
                                        jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').show();

                                        // Remove current options
                                        jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').html('');
                                        jQuery.each(data, function (k, v) {
                                            if (pos) {
                                                lan = k;
                                                jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').append('<option value="' + v + '">' + k + '</option>');
                                                pos = false;
                                            } else {
                                                if (jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').val() == lan) {
                                                    jQuery('#ss_fmbbundle_preparationcorde_qte').show();
                                                    jQuery('#ss_fmbbundle_preparationcorde_qte').val(v);
                                                }
                                                pos = true;
                                            }
                                        });
                                        jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                                    }
                                }
                            });
                        }
                    }
                });
                return false;
            });
            jQuery('#ss_fmbbundle_preparationcorde_refArticle').change(function () {
                jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').hide()
                jQuery('#ss_fmbbundle_preparationcorde_qte').hide();
                jQuery.ajax({
                    type: "POST",
                    url: "{{ url('ssfmb_articlestock') }}?stock_id=" + jQuery('#ss_fmbbundle_preparationcorde_libStock').val() + "&article=" + jQuery('#ss_fmbbundle_preparationcorde_refArticle').val(),
                    success: function (data) {
                        if (jQuery.trim(data)) {
                            var pos = true;
                            var lan = '';
                            jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').show();

                            // Remove current options
                            jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').html('');
                            jQuery.each(data, function (k, v) {
                                if (pos) {
                                    lan = k;
                                    jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').append('<option value="' + v + '">' + k + '</option>');
                                    pos = false;
                                } else {
                                    if (jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').val() == lan) {
                                        jQuery('#ss_fmbbundle_preparationcorde_qte').show();
                                        jQuery('#ss_fmbbundle_preparationcorde_qte').val(v);
                                    }
                                    pos = true;

                                }
                            });
                            jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                        }
                    }
                });
            });

            jQuery('#ss_fmbbundle_preparationcorde_Parc').change(function () {
                jQuery('#ss_fmbbundle_preparationcorde_libStock').hide();
                jQuery('#ss_fmbbundle_preparationcorde_nomCorde').hide();
                jQuery('#ss_fmbbundle_preparationcorde_qte').hide();
                jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').hide();
                jQuery('#ss_fmbbundle_preparationcorde_submit').hide();
                jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').hide()
                var val = jQuery(this).val();
                jQuery.ajax({
                    type: "POST",
                    url: "{{ url('ssfmb_parcstock') }}?parc_id=" + val,
                    success: function (data) {
                        if (jQuery.trim(data)) {
                            jQuery('#ss_fmbbundle_preparationcorde_libStock').show();

                            // Remove current options
                            jQuery('#ss_fmbbundle_preparationcorde_libStock').html('');
                            jQuery.each(data, function (k, v) {
                                jQuery('#ss_fmbbundle_preparationcorde_libStock').append('<option value="' + v + '">' + k + '</option>');
                            });
                            jQuery.ajax({
                                type: "POST",
                                url: "{{ url('ssfmb_parccorde') }}?parc_id=" + val,
                                success: function (data) {
                                    if (jQuery.trim(data)) {
                                        var pos = true;
                                        var lan = '';
                                        jQuery('#ss_fmbbundle_preparationcorde_nomCorde').show();

                                        // Remove current options
                                        jQuery('#ss_fmbbundle_preparationcorde_nomCorde').html('');
                                        jQuery.each(data, function (k, v) {
                                            if (pos) {
                                                lan = k;
                                                jQuery('#ss_fmbbundle_preparationcorde_nomCorde').append('<option value="' + v + '">' + k + '</option>');
                                                pos = false;
                                            } else {
                                                if (jQuery('#ss_fmbbundle_preparationcorde_nomCorde').val() == lan) {
                                                    jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').show();
                                                    jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').val(v);
                                                }
                                                pos = true;

                                            }
                                        });
                                        jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                                    }
                                }
                            });
                            jQuery.ajax({
                                type: "POST",
                                url: "{{ url('ssfmb_articlestock') }}?stock_id=" + jQuery('#ss_fmbbundle_preparationcorde_libStock').val() + "&article=" + jQuery('#ss_fmbbundle_preparationcorde_refArticle').val(),
                                success: function (data) {
                                    if (jQuery.trim(data)) {
                                        var pos = true;
                                        var lan = '';
                                        jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').show();

                                        // Remove current options
                                        jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').html('');
                                        jQuery.each(data, function (k, v) {
                                            if (pos) {
                                                lan = k;
                                                jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').append('<option value="' + v + '">' + k + '</option>');
                                                pos = false;
                                            } else {
                                                if (jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').val() == lan) {
                                                    jQuery('#ss_fmbbundle_preparationcorde_qte').show();
                                                    jQuery('#ss_fmbbundle_preparationcorde_qte').val(v);
                                                }
                                                pos = true;

                                            }
                                        });
                                        jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                                    }
                                }
                            });
                        }
                    }
                });
                return false;
            });
            jQuery('#ss_fmbbundle_preparationcorde_nomCorde').change(function () {
                jQuery('#ss_fmbbundle_preparationcorde_submit').hide();
                jQuery('#ss_fmbbundle_preparationcorde_nomCorde').hide();
                jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').hide();
                var val = jQuery("#ss_fmbbundle_preparationcorde_Parc").val();

                jQuery.ajax({
                    type: "POST",
                    url: "{{ url('ssfmb_parccorde') }}?parc_id=" + val,
                    success: function (data) {
                        if (jQuery.trim(data)) {
                            var pos = true;
                            var lan = '';
                            jQuery('#ss_fmbbundle_preparationcorde_nomCorde').show();
                            jQuery.each(data, function (k, v) {
                                if (pos) {
                                    lan = k;
                                    pos = false;
                                } else {
                                    if (jQuery('#ss_fmbbundle_preparationcorde_nomCorde').val() == lan) {
                                        jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').show();
                                        jQuery('#ss_fmbbundle_preparationcorde_quantiterEnStock').val(v);
                                    }
                                    pos = true;

                                }
                            });
                            jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                        }
                    }
                });
            });

            jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').change(function () {
                jQuery('#ss_fmbbundle_preparationcorde_submit').hide();
                jQuery('#ss_fmbbundle_preparationcorde_qte').hide();
                var val = jQuery("#ss_fmbbundle_preparationcorde_Parc").val();

                jQuery.ajax({
                    type: "POST",
                    url: "{{ url('ssfmb_articlestocklot') }}?stock_id=" + jQuery('#ss_fmbbundle_preparationcorde_libStock').val() + "&article=" + jQuery('#ss_fmbbundle_preparationcorde_refArticle').val() + "&lot=" + jQuery('#ss_fmbbundle_preparationcorde_numeroSerie').val(),
                    success: function (data) {
                        if (jQuery.trim(data)) {
                            jQuery('#ss_fmbbundle_preparationcorde_qte').show();
                            // Remove current options
                            jQuery('#ss_fmbbundle_preparationcorde_qte').html('');
                            jQuery.each(data, function (k, v) {
                                jQuery('#ss_fmbbundle_preparationcorde_qte').val(v);
                            });
                            jQuery('#ss_fmbbundle_preparationcorde_submit').show();
                        }
                    }
                });
            });
        });
    </script>
{% endblock %}
